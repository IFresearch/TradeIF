# 🚀 快速开始指南

欢迎使用 TradeIF 量化回测系统！本指南将帮助您快速上手系统的各项功能。

---

## 📋 系统概述

TradeIF 是一个基于Python和FastAPI的股票量化交易回测系统，支持多种预设策略和自定义策略开发，具备智能缓存机制，提供专业的Web界面。

---

## 🎯 支持的交易策略

### 1️⃣ 双均线交叉策略 (MA Cross) ⭐推荐新手

**策略原理**
- 当短期均线上穿长期均线时买入（金叉）
- 当短期均线下穿长期均线时卖出（死叉）

**参数配置**
- 短期均线：建议5-30天（默认20天）
- 长期均线：建议30-200天（默认50天）

**适用场景**：趋势明显的市场环境

**优点**：简单易懂，适合新手入门  
**缺点**：在震荡市场可能产生频繁交易

---

### 2️⃣ RSI超买超卖策略

**策略原理**
- RSI < 超卖阈值时买入（认为股票被低估）
- RSI > 超买阈值时卖出（认为股票被高估）
- 包含止损止盈保护机制

**参数配置**
- RSI周期：建议14天
- 超卖阈值：建议20-30（默认30）
- 超买阈值：建议70-80（默认70）
- 止损比例：建议3-8%（默认5%）
- 止盈比例：建议8-20%（默认10%）

**适用场景**：震荡市场，反转交易

**优点**：有明确的止损止盈保护  
**缺点**：趋势市场可能过早退出

---

### 3️⃣ 布林带策略 (Bollinger Bands)

**策略原理**
- 价格突破上轨时考虑卖出
- 价格跌破下轨时考虑买入
- 基于均值回归理论

**参数配置**
- 周期：建议20天
- 标准差倍数：建议1.5-2.5（默认2.0）
- 可设置止损止盈

**适用场景**：震荡行情，均值回归

**优点**：动态调整交易区间  
**缺点**：强趋势市场表现较差

---

## 🔧 使用流程

### 第一步：启动系统

```bash
# Windows用户
python backend\api\main.py

# 或者直接双击
start.bat

# Linux/Mac用户
python backend/api/main.py
```

启动成功后，您会看到：
```
INFO:     Uvicorn running on http://127.0.0.1:8000
```

### 第二步：访问系统

打开浏览器，访问：**http://127.0.0.1:8000**

### 第三步：选择股票和时间范围

1. **输入股票代码**：
   - 深圳股票：`000001.SZ` (平安银行)
   - 上海股票：`600000.SH` (浦发银行)
   - 支持股票名称搜索

2. **设置时间范围**：
   - 建议至少1年以上数据
   - 示例：2023-01-01 到 2024-12-31

3. **设定初始资金**：
   - 默认：100,000元
   - 可根据需求调整

4. **点击"加载数据"按钮**

### 第四步：选择策略

在策略下拉菜单中选择：

- **双均线交叉策略** - 适合新手，趋势跟踪
- **RSI超买超卖策略** - 适合震荡市，有止损止盈
- **布林带策略** - 适合均值回归
- **自定义策略** - 高级用户，自己编写策略逻辑

### 第五步：调整参数

根据选择的策略，调整对应参数：

**保守型参数设置**（降低交易频率）
- 更长的周期
- 更严格的阈值
- 较大的止损止盈区间

**激进型参数设置**（增加交易频率）
- 更短的周期
- 更宽松的阈值
- 较小的止损止盈区间

### 第六步：运行回测

1. 点击 **"运行回测"** 按钮
2. 等待系统计算（通常1-3秒）
3. 查看回测结果

---

## 📊 结果解读

### 关键指标说明

| 指标 | 含义 | 参考标准 |
|------|------|----------|
| **总收益率** | 策略整体盈亏百分比 | >0为盈利 |
| **年化收益率** | 按年计算的收益率 | >10%为良好 |
| **夏普比率** | 风险调整后收益 | >1.5较好，>2优秀 |
| **最大回撤** | 最大亏损幅度 | <20%可接受 |
| **胜率** | 盈利交易占比 | >50%较好 |
| **交易次数** | 总交易笔数 | 过多或过少都需注意 |

### 图表说明

**价格图表**（上方）
- 显示K线图和交易信号
- 绿色向上箭头：买入信号
- 红色向下箭头：卖出信号
- 鼠标悬停可查看详细信息

**权益曲线**（下方）
- 展示账户资金变化
- 向上趋势：策略盈利
- 向下趋势：策略亏损
- 波动幅度反映风险水平

**交易记录表**
- 完整的买卖记录
- 包括日期、操作、价格、数量、原因

---

## 🎨 自定义策略开发

### 快速开始

1. 选择策略下拉框中的 **"自定义策略"**
2. 在Monaco编辑器中编写策略代码
3. 点击 **"运行回测"** 测试策略

### 基本模板

```python
# 双均线交叉策略示例
if not pd.isna(current.ma5) and not pd.isna(current.ma20):
    if not pd.isna(prev.ma5) and not pd.isna(prev.ma20):
        # 金叉买入
        if current.ma5 > current.ma20 and prev.ma5 <= prev.ma20 and position == 0:
            signal = 1
            reason = 'MA金叉买入'
        # 死叉卖出
        elif current.ma5 < current.ma20 and prev.ma5 >= prev.ma20 and position > 0:
            signal = -1
            reason = 'MA死叉卖出'
        else:
            signal = 0
            reason = ''
```

### 可用变量

- `current` - 当前K线数据（如 `current.close`, `current.ma20`）
- `prev` - 前一根K线数据
- `position` - 当前持仓（0=空仓，>0=持仓）
- `entry_price` - 买入价格
- `signal` - 交易信号（1=买入，-1=卖出，0=无操作）
- `reason` - 交易原因说明

详细开发指南请参阅：[自定义策略开发文档](docs/CUSTOM_STRATEGY_GUIDE.md)

---

## 💡 使用技巧

### 1. 参数优化

通过调整参数找到最优配置：

```
短期均线：10, 15, 20, 25, 30
长期均线：30, 50, 60, 100, 200
```

逐一尝试不同组合，对比回测结果

### 2. 多策略对比

对同一股票使用不同策略回测，比较表现：
- 记录各策略的关键指标
- 选择最适合该股票的策略

### 3. 时间周期测试

在不同时间段测试策略稳定性：
- 牛市周期
- 熊市周期
- 震荡周期

### 4. 风险控制

关注最大回撤指标：
- 回撤>30%需要调整策略
- 设置合理的止损止盈
- 避免过度交易

---

## 🛠️ 故障排查

### 问题1：数据加载失败

**可能原因**
- Tushare Token未配置或失效
- 网络连接问题
- 股票代码格式错误

**解决方案**
1. 检查 `config/config.yaml` 中的Token
2. 确认网络连接正常
3. 使用正确格式：`000001.SZ` 或 `600000.SH`

### 问题2：回测无结果

**可能原因**
- 数据范围太短
- 策略参数设置不当
- 数据质量问题

**解决方案**
1. 增加回测时间范围（建议≥1年）
2. 调整策略参数
3. 更换股票代码测试

### 问题3：自定义策略报错

**可能原因**
- 代码语法错误
- 使用了不存在的指标
- 逻辑错误

**解决方案**
1. 检查Monaco编辑器中的错误提示
2. 参考示例代码
3. 查看可用指标列表（见自定义策略文档）

### 问题4：端口被占用

**错误信息**
```
Error: Address already in use
```

**解决方案**
```bash
# Windows - 查找占用8000端口的进程
netstat -ano | findstr :8000
# 结束进程（替换PID为实际进程ID）
taskkill /F /PID <PID>

# Linux/Mac
lsof -ti:8000 | xargs kill -9
```

---

## 📈 最佳实践

### 1. 策略开发流程

```
1. 确定交易思路
   ↓
2. 选择技术指标
   ↓
3. 编写策略代码
   ↓
4. 回测验证
   ↓
5. 参数优化
   ↓
6. 多股票测试
   ↓
7. 实盘模拟
```

### 2. 参数设置建议

**双均线策略**
- 短周期：5-30天
- 长周期：30-200天
- 常用组合：(5,20), (10,50), (20,60)

**RSI策略**
- 周期：14天
- 超卖：20-30
- 超买：70-80
- 止损：3-5%
- 止盈：8-15%

**布林带策略**
- 周期：20天
- 标准差：2.0
- 可结合RSI确认

### 3. 数据质量检查

回测前检查数据：
- 是否有缺失值
- 是否有异常值
- 数据时间跨度是否足够

### 4. 结果验证

- 对比不同时间段的表现
- 测试多个股票验证策略普适性
- 关注交易频率是否合理
- 检查是否过拟合

---

## 🔗 相关资源

- **项目主页**: [README.md](README.md)
- **策略开发**: [自定义策略指南](docs/CUSTOM_STRATEGY_GUIDE.md)
- **Tushare官网**: https://tushare.pro
- **TradingView**: https://www.tradingview.com

---

## 📞 获取帮助

遇到问题？

1. 查看本指南的故障排查部分
2. 阅读 [README.md](README.md) 中的常见问题
3. 提交 GitHub Issue

---

<div align="center">
  <sub>祝您回测顺利，投资成功！</sub>
</div>
